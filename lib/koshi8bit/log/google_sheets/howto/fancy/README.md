# Работа с Google Sheets


Перед тем как мы начнем работу с Google Sheets, необходимо настроить Ваш проект. Это не займет много времени и сил, если Вы будете следовать строго по инструкции. Итак, начнем!
1. Если у Вас еще нет аккаунта гугл, создайте его.
2. Переходим к [созданию проекта](https://console.cloud.google.com/cloud-resource-manager): перейдите по этой ссылки и нажмите "Создать проект".
   
   ![создать](./Create.png)
   
3. Придумайте и введите имя проекта, с учетом допустимых символов. Нажмите «Создать».
   
   ![имя проекта](name.png)
   
4. Переходим по [ссылке](https://console.cloud.google.com/iam-admin/iam). Посмотрите,чтобы роль вашего аккаунта была "Владелец".
   
   ![роль](role.png)
   
   * Если это не так, нажмите на редактирование.
   
   ![редактирование](change_role.png)
   
   * Нажмите на выподающее меню
   
   ![меню](edit.png)
   
   * Выберите "Владелец" и сохраните изменения.
   
   ![владелец](owner.png)
   
5. Перейдите по [ссылке](https://console.cloud.google.com/iam-admin/serviceaccounts) для настройки сервисного аккаунта. 
   
   * Нажмите "Создать сервисный аккаунт".
   
   ![сервисный аккаунт](create_service_acc.png)
   
   * Введите любое имя для сервисного аккауна и нажмите "Создать и продолжить". id сгенерируется автоматически.
   
   ![имя сервисного аккаунта](name_service_acc.png)
   
   * Нажмите на выподающее меню и выберете роль "Владельца". Нажмите "продолжить".
   
   ![роль сервисного аккаунта](role_service_acc.png)  ![выберете роль владельца](select_owner.png)
   
   * Данные поля оставляем пустыми, нажимаем "сделать".
   
   ![сделать](done.png)
   
6. Скопируйте и сохраните email сервисного аккаунта. Он понадобится потом для предоставления доступа к таблицам.
   
   ![email](email.png)
   
7. Теперь нам нужно сгенерировать ключ. 
   
   * Для этого нажмите на три точки и выберите "Управление ключами".
   
   ![путь к ключу](path_to_key.png)
     
   * Нажмите "Добавить ключ" и выберете "Создать новый ключ" .
   
   ![создать ключ](create_new_key.png)
     
   * Выберите тип JSON и нажмите "Создать". После этого на ваш компьютер скачается созданный ключ. Сохраните его, скоро
   он нам понадобится. После этого у Вас на экране появится окошко, которое нужно будет закрыть. Оно просто оповещает 
   Вас о том, что ключ скачался.
   
   ![ключ](new_key.png)
   
8. Перейдите по [ссылке](https://console.cloud.google.com/apis/dashboard),  чтобы включить необходимые сервисы.
   
   * Нажмите "Включить API и сервисы".
   
   ![включить](add_api.png)  
   
   * Введите в строку поиска «google drive» и кликните по сервису «Google Drive API»

   ![гугл диск](google_drive.png)

   *  Нажмите "Включить"
   
   ![включить диск](enable.png)

   * Снова переходим по [ссылке](https://console.cloud.google.com/apis/dashboard) и нажимаем "Включить API и сервисы".

   ![включить](add_api.png)

   * Введите в строку поиска «sheet» и кликните на сервисе «Google Sheets API»

   ![гугл таблица](sheet.png)
   
   *  Нажмите "Включить"

   ![включить таблицу](enable_sheet.png)
   
9. Заходим в таблицы с тем аккаунтом, который настраивали для проекта.

   ![таблица](tabl.png)
      
   * Создаем пустой файл.
   
   ![пустой файл](empty_file.png)

   * Нажимаем на настройки доступа.
   
   ![настройки доступа](settings.png)

   * Придумываем имя для таблицы, записываем его и сохраняем.
   
   ![имя таблицы](data.png)

   * Вставляем наш сохранненый сервисный аккаунт (п.6) и нажимаем на всплывшее окно. 

   ![добавление аккаунта](select_serv_acc.png)
   
   * Выбираем роль редактора и нажимаем "Отправить".
   
   ![роль пользователя](select_editor.png)

10. Перейдите по [ссылке](https://github.com/koshi8bit/lib-py) и скачайте библиотеку работы с google sheets. 
    Если Вы работете в PyCharm - ниже приведена пошаговая инструкция

    * Нажмите на Code и скопируйте https ссылку

    ![скачайте репозиторий](clone.png)

    * Откройте PyCharm и нажмите "Get from VCS".

    ![создать проект](VCS.png)

    * Вставьте скопированную ссылку и нажмите clone.
   
    ![clone](link.png)

    * Вам придет запрос на создание виртуального окружения. Нажмите ok.

    ![виртуальное окружение](virtual_env.png)

    * Переименуйте сгенеренный ранее и сохраненный на вашем компьютере ключ в creds.json и прикрепите его к проекту. 
   
    ![структура файла](file_code.png)

    * Создайте класс main
   
    ![создать класс](create_main.png)   ![main](main.png)

    * Добавьте туда данный код:
   ```from lib.koshi8bit.log.google_sheets.google_sheets import GoogleSheets

   if __name__ == '__main__':
        gs = GoogleSheets('creds.json', 'https://docs.google.com/spreadsheets/d/1aFk2e7fnHUCF1p61RTWp4t4auysu7dLkr_9M7WD3HdY/edit#gid=0')

        cell = gs.read_cell('Лист11', 'A1')
        print(cell)

        data = [[1, '2', 3], [4, 's5', 6]]
        res = gs.write('Лист11', 'B2:D', data)

        lines = gs.read('Лист11', 'A1:D4')
        print(lines)
   ```

11. Вернемся снова к гугл таблице. Сохраните весь url и вставьте в код вторым аргументом в класс GoogleSheets.

   ![путь для таблицы](path.png)

12. Переименуйте Лист1 в Лист11 или так как Вам хочется. Зафиксируйте это первым аргументом в read_cell.

   ![Лист](List.png)

13. Запустите проект. У Вас должно получиться что-то такое:
 
   ![пример вывода](ex_code.png)   ![пример таблицы](ex_table.png)

   





   
   
   

